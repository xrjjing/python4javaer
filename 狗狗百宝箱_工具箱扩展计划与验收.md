# 狗狗百宝箱「工具箱扩展」计划与验收用例（v1）

更新日期：2025-12-13  
适用项目：`desktop_tools`（狗狗百宝箱）

---

## 0. 进度标记

- ✅ **M1 已完成**：NAV-001（二级导航+工具页空壳）（完成日期：2025-12-12）
- ✅ **M2 已完成**：TOOL-001（Base64）、TOOL-002（UUID）、TOOL-010（变量命名转换）（完成日期：2025-12-12）
- ✅ **M3 已完成**：TOOL-008（JWT 解码）、TOOL-009（时间戳转换）（完成日期：2025-12-13）
- ✅ **M4 已完成**：TOOL-003（哈希）（完成日期：2025-12-13）
- ✅ **M5 已完成**：TOOL-004/005（AES/DES）（完成日期：2025-12-13）
- ✅ **M6 已完成**：TOOL-007（文本对比）（完成日期：2025-12-13）
- ✅ **M7 已完成**：TOOL-006（Base64 ↔ Hex）（完成日期：2025-12-13）

---

## 1. 目标与硬约束（必须遵守）

### 1.1 目标
- 在不影响现有功能的前提下，引入**二级导航**与一组常用离线工具（编码/哈希/加解密/对比/时间戳/JWT/命名转换等）。

### 1.2 硬约束
- **不影响现有功能**：密码管理、命令管理、节点转换、节点列表（原节点管理）、主题切换、导入、拖拽排序等行为保持一致。
- **离线可用**：所有工具默认本地计算，不依赖外部网络服务。
- **统一输入输出**：
  - 明文/文本输入统一按 **UTF-8** 处理。
  - 二进制结果统一支持 **Base64 / Hex** 输出与复制。
  - 每个工具页至少提供：`清空`、`复制结果`、错误信息区域。
- **安全与隐私**：
  - 密钥/明文/盐等敏感输入**不落盘**、不写日志。
  - 提供“一键清空输入/输出”。

---

## 2. 现状梳理（作为基线）

当前狗狗百宝箱前端为单页结构（`desktop_tools/web/index.html`），左侧导航通过 `data-page` 切换右侧 `section#page-xxx`：
- `密码管理`（`page-credentials`）
- `命令管理`（`page-commands`）
- `节点转换`（`page-converter`）
- `节点管理`（实际为节点列表，`page-nodes`）

> 本计划将“节点管理”改名为“节点列表”，并引入“工具箱”相关页面。

---

## 3. 信息架构与导航改造（支持二级分类）

### 3.1 一级/二级导航结构（建议方案）
- **密码管理**（一级，现有）
- **命令管理**（一级，现有）
- **节点管理**（一级，新增二级）
  - **节点转换**（二级，现有 `page-converter`）
  - **节点列表**（二级，原“节点管理” `page-nodes`，仅改显示名）
- **工具箱**（一级，新增二级）
  - Base64 编解码
  - UUID 生成器
  - 哈希（MD5 / SHA-256，支持加盐/批量）
  - 对称加密（AES / DES）
  - Base64 ↔ Hex 互转
  - 文本对比（Text / JSON）
  - JWT 解码
  - 时间戳转换（仅 UTC / UTC+8）
  - 变量命名转换（7 种格式）

### 3.2 导航交互规则
- 一级分组可折叠/展开（默认展开当前分组，其他分组可折叠）。
- 点击二级项切换页面：只激活**一个叶子页面**。
- 页面切换仅影响显示，不应触发现有数据写入行为。

---

## 4. 截图 UI 关键点（作为对齐参考）

### 4.1 AES/DES 加解密（ECB + PKCS7）
从截图可识别的结构与控件要点：
- 顶部：`加密` / `解密` 切换。
- 输入区右上：`utf-8` 下拉 + `文本` 下拉（视作输入编码/类型）。
- 模式：`高级` / `简单` 切换。
- 高级参数：
  - AES：`ECB` 下拉、`128/256` 下拉、`Pkcs7` 下拉、`key` 输入框、`iv` 输入框（ECB 下灰置）。
  - DES：`ECB` 下拉、`Pkcs7` 下拉、`key`、`iv`（ECB 下灰置）。
- 输出区右侧：结果格式下拉：`Base64` / `Hex`。

### 4.2 时间戳转换
从截图可识别的结构与控件要点：
- 顶部 Tab：`时间戳` / `时区` / `计算器`。
- 时区：示例 `UTC+08:00 Asia/Shanghai - 上海`。
- 输入：数字输入，右侧有“自动识别类型”下拉 + `清空`。
- 输出：秒/毫秒/纳秒三行展示，带 `复制`。
- 下方列表：`格式 | 值 | 操作(加载)`，点击“加载”将该值回填到输入。
- 你补充的行为：**下方时间为实时动态，但仅进入该页面才触发**（页面离开后应停止定时刷新）。

### 4.3 变量命名转换（7 种格式）
截图输出格式共 7 种，需要补充中文名称（括号保留英文）：
- 空格小写（space case）
- 单词首字母大写（Camel Case）
- 连字符小写（kebab-case）
- 下划线全大写（SNAKE_CASE）
- 大驼峰（CamelCase）
- 小驼峰（camelCase）
- 下划线小写（snake_case）

---

## 5. 需求清单（每一项都是独立需求）

### NAV-001 二级导航改造 + 节点分组重命名
**状态：✅ 已完成（2025-12-12）**

**需求描述**
- 左侧支持二级分类。
- `节点转换` 与 `节点列表` 归属 `节点管理` 分组。
- 原“节点管理”更名为“节点列表”。
- `密码管理`、`命令管理`保持一级入口。
- 新增 `工具箱` 一级分组，包含后续工具页入口。

**拆分任务**
1. 调整 `sidebar` DOM 结构，支持“分组项 + 子项”。
2. 导航状态管理：折叠/展开、当前激活、默认页策略。
3. 样式：子项缩进、分隔线、滚动容器（避免工具项过多挤压主题按钮）。
4. 回归：所有旧页面可达且按钮事件不受影响。

**验收标准**
- 节点转换与节点列表位于“节点管理”下，功能不变。
- 密码管理、命令管理入口不变。
- 工具箱入口可切页（即使工具页先为空壳）。

---

### TOOL-001 Base64 编码/解码
**状态：✅ 已完成（2025-12-12）**

**功能**
- 文本（UTF-8）→ Base64
- Base64 → 文本（UTF-8）
- 支持：单条/批量（按行）模式切换

**验收标准**
- `hello` 编码得到 `aGVsbG8=`；解码回 `hello`。
- 中文 `你好` 编码得到 `5L2g5aW9`；解码回 `你好`。
- 非法 Base64 输入不会崩溃，提示错误。

---

### TOOL-002 UUID 生成器
**状态：✅ 已完成（2025-12-12）**

**功能**
- 生成 UUID v4
- 支持：单个/批量（N 条）生成
- 支持：大小写、是否带连字符（`-`）

**验收标准**
- 批量生成 N 条（如 10 条）不明显卡顿。
- UUID 格式合法（带连字符：`8-4-4-4-12`，十六进制字符）。
- 同批次生成不应出现重复。

---

### TOOL-003 哈希（MD5 / SHA-256，UTF-8，可选加盐，支持批量）
**状态：✅ 已完成（2025-12-13）**

**规则（根据你的确认）**
- 盐策略仅提供一种：**后缀加盐**（即 `明文 + 盐`）。
- 盐可选：不加盐 / 加盐（用户输入盐字符串，UTF-8）。
- 输出格式：小写 Hex。
- 批量模式：按行输出对应 hash，**空行输出空行**（保持行对齐）。

**验收标准**
- 不加盐：
  - `md5("hello") = 5d41402abc4b2a76b9719d911017c592`
  - `sha256("hello") = 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824`
- 加盐（盐=`salt`，后缀）：
  - `md5("hellosalt") = baddf52697306303627b97b2721e964a`
  - `sha256("hellosalt") = 87daba3fe263b34c335a0ee3b28ffec4d159aad6542502eaf551dc7b9128c267`

---

### TOOL-004 对称加密：AES 加解密（ECB，PKCS7，支持 128/256）
**状态：✅ 已完成（2025-12-13）**

**功能**
- 算法：AES
- 模式：ECB
- 填充：PKCS7
- 明文：UTF-8 文本
- 密文输出：Base64 或 Hex（可选）
- 密文输入：Base64 或 Hex（可选/自动识别由实现决定）
- Key 长度：支持 `128` / `256`

**Key 处理策略（结合你的问题“补齐 vs 截断”）**
- 现实使用中，用户输入的 key 往往短于 16/32 字节，因此**补齐更常见**。
- 为避免“悄悄截断/补齐”带来不可预期，计划采用：  
  - 默认开启：**自动调整 key 长度**  
  - 规则：将 key 按 UTF-8 转字节后  
    - 不足：右侧补 `0x00` 直到目标长度  
    - 超出：截断到目标长度  
  - 同时提供开关：关闭后要求严格长度（不满足则提示错误）

**验收标准（已知向量，key 为 ASCII，避免补齐/截断干扰）**
- AES-128-ECB + PKCS7：
  - key：`1234567890abcdef`
  - 明文：`hello`
  - Base64：`OuG/HtvQGRTDeeep6ZO/WQ==`
  - Hex：`3ae1bf1edbd01914c379e7a9e993bf59`
- AES-256-ECB + PKCS7：
  - key：`1234567890abcdef1234567890abcdef`
  - 明文：`hello`
  - Base64：`GL32xozLGGfcR605S5ZAyw==`
  - Hex：`18bdf6c68ccb1867dc47ad394b9640cb`
- 错误 key / 错误密文格式：给出错误提示，不崩溃。

---

### TOOL-005 对称加密：DES 加解密（ECB，PKCS7）
**状态：✅ 已完成（2025-12-13）**

**功能**
- 算法：DES
- 模式：ECB
- 填充：PKCS7
- 明文：UTF-8 文本
- 密文输出：Base64 或 Hex
- key 处理：与 AES 相同（UTF-8 → 不足补 `0x00` / 超出截断；可关闭自动调整）

**验收标准（已知向量）**
- DES-ECB + PKCS7：
  - key：`12345678`
  - 明文：`hello`
  - Base64：`uhbGoCVxJa8=`
  - Hex：`ba16c6a0257125af`

---

### TOOL-006 Base64 ↔ Hex 互转
**状态：✅ 已完成（2025-12-13）**

**功能**
- Base64 → Hex
- Hex → Base64
- 支持：单条/批量（按行）

**验收标准**
- `aGVsbG8=` ↔ `68656c6c6f`
- 非法 Hex（奇数长度/非 0-9a-f）提示错误，不崩溃。

---

### TOOL-007 文本对比（Text/JSON 格式化、自动换行、方向）
**状态：✅ 已完成（2025-12-13）**

**功能**
- 左右双栏输入。
- 模式：Text / JSON
  - JSON 模式支持格式化（pretty）再对比。
- 自动换行开关。
- 对比方向：左→右 / 右→左（影响后续“应用变更/覆盖”的方向）。

**验收标准**
- Text 模式能高亮差异；开启/关闭换行不影响内容。
- JSON 模式：合法 JSON 可格式化；非法 JSON 给出错误提示。
- 方向切换后，“应用到对侧”的按钮行为符合方向预期。

---

### TOOL-008 JWT 解码（可选 header/payload 输出）
**状态：✅ 已完成（2025-12-13）**

**功能**
- 支持输入：`header.payload.signature` / `header.payload` / 仅 payload（手动指定）。
- 输出：Header JSON、Payload JSON（可开关）。
- 支持 base64url 解码、JSON 格式化。

**验收标准（示例 JWT）**
- 输入：
  - `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`
- 输出 Header：
  - `{\"alg\":\"HS256\",\"typ\":\"JWT\"}`
- 输出 Payload：
  - `{\"sub\":\"1234567890\",\"name\":\"John Doe\",\"iat\":1516239022}`
- 不做签名校验，但需提示“未校验签名”。

---

### TOOL-009 时间戳转换（仅 UTC / UTC+8，进入页面才实时刷新）
**状态：✅ 已完成（2025-12-13）**

**功能**
- 时区：仅提供 `UTC` 与 `UTC+8(Asia/Shanghai)`。
- 输入类型自动识别：
  - Unix 时间戳：秒/毫秒/纳秒
  - 标准时间字符串（如 `YYYY-MM-DD HH:mm:ss`，可扩展毫秒）
- 输出：秒/毫秒/纳秒三行展示并可复制。
- “格式列表 + 加载”。
- 实时动态：页面**进入**时启动定时刷新，页面**离开**时停止。

**验收标准**
- 进入页面后，至少每秒更新一次“当前时间/当前时间戳”展示（具体展示字段在实现时定义，但必须可感知）。
- 离开该页面后停止刷新（避免后台占用）。
- 输入 `0` 在 UTC 下输出 `1970-01-01 00:00:00`（或等价格式）。

---

### TOOL-010 变量命名转换（7 种格式，补充中文名）
**状态：✅ 已完成（2025-12-12）**

**功能**
- 输入任意一种命名（camel/snake/kebab/空格/大小写混合），自动拆词。
- 输出 7 种格式，并展示中文名称（括号英文）：
  - 空格小写（space case）
  - 单词首字母大写（Camel Case）
  - 连字符小写（kebab-case）
  - 下划线全大写（SNAKE_CASE）
  - 大驼峰（CamelCase）
  - 小驼峰（camelCase）
  - 下划线小写（snake_case）

**验收标准**
- 输入 `userAge` 输出：
  - 空格小写：`user age`
  - 单词首字母大写：`User Age`
  - 连字符：`user-age`
  - 下划线全大写：`USER_AGE`
  - 大驼峰：`UserAge`
  - 小驼峰：`userAge`
  - 下划线小写：`user_age`

---

## 6. 实施顺序（严格按里程碑推进）

### ✅ M1 导航与工具壳（低风险，已完成）
- NAV-001
- 新增工具页空壳（不要求功能全部实现，但页面路由要稳定）
- 回归：旧功能可达/可用

### ✅ M2 纯解析/纯算法工具（风险低，已完成）
- TOOL-001 Base64
- TOOL-002 UUID
- TOOL-010 变量命名转换

### ✅ M3 解析工具（规则清晰，已完成）
- TOOL-008 JWT 解码
- TOOL-009 时间戳转换（含进入页面才实时刷新）

### ✅ M4 哈希（已完成）
- TOOL-003 哈希（MD5/SHA256，加盐/批量）

### ✅ M5 对称加密（算法实现，风险中高，已完成）
- TOOL-004 AES（128/256）
- TOOL-005 DES

### ✅ M6 文本对比（体验与性能，已完成）
- TOOL-007 文本对比（Text/JSON）

### ✅ M7 编码互转补齐（已完成）
- TOOL-006 Base64 ↔ Hex

> 里程碑完成条件：本里程碑涉及的“验收用例”全部通过 + 不回归旧功能。

---

## 7. 验收用例清单（按需求编号组织）

> 说明：用例以“手工验收”为主，后续如引入自动化测试，会将部分用例固化为脚本/单测。

### 7.1 旧功能回归（必须每个里程碑都跑）
- **REG-001 密码管理新增/编辑/删除**
  1. 新增一条记录（服务名必填）
  2. 编辑账号/密码/附加信息并保存
  3. 删除该记录并确认列表为空/减少
  - 期望：均成功，页面无异常
- **REG-002 密码管理搜索**
  - 输入关键字过滤，清空关键字恢复
- **REG-003 命令管理页签/命令块**
  - 新增页签、在页签下新增命令块、拖拽排序、删除命令块
- **REG-004 节点转换/节点列表**
  - 粘贴 1 条节点链接转换，输出不为空；保存后在节点列表可见；删除可生效
- **REG-005 主题切换**
  - 切换主题后刷新应用仍保持主题（若现有逻辑如此）

### 7.2 NAV-001 二级导航
- **TC-NAV-001 分组展示**
  - 期望：左侧存在“节点管理”“工具箱”分组；节点管理下有“节点转换/节点列表”
- **TC-NAV-002 切页正确**
  - 点击任一二级项，仅对应页面显示为 active，其他隐藏
- **TC-NAV-003 不影响旧按钮**
  - 在密码管理页点击“添加记录/批量导入”仍可用

### 7.3 TOOL-001 Base64
- **TC-B64-001 编码**
  - 输入：`hello` → 期望：`aGVsbG8=`
- **TC-B64-002 解码**
  - 输入：`aGVsbG8=` → 期望：`hello`
- **TC-B64-003 中文**
  - 输入：`你好` → 期望：`5L2g5aW9`
- **TC-B64-004 非法输入**
  - 输入：`@@@` 解码 → 期望：提示“非法 Base64”，不崩溃

### 7.4 TOOL-002 UUID
- **TC-UUID-001 单个**
  - 生成 1 个 UUID（带连字符）→ 期望：格式正确
- **TC-UUID-002 批量**
  - 生成 10 个 → 期望：10 行、不重复

### 7.5 TOOL-003 哈希
- **TC-HASH-001 md5 无盐**
  - 输入：`hello` 算法 MD5 → 期望：`5d41402abc4b2a76b9719d911017c592`
- **TC-HASH-002 sha256 无盐**
  - 输入：`hello` 算法 SHA-256 → 期望：`2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824`
- **TC-HASH-003 加盐（后缀）**
  - 输入：`hello`，盐：`salt`，算法 MD5 → 期望：`baddf52697306303627b97b2721e964a`
  - 输入：`hello`，盐：`salt`，算法 SHA-256 → 期望：`87daba3fe263b34c335a0ee3b28ffec4d159aad6542502eaf551dc7b9128c267`

### 7.6 TOOL-004 AES
- **TC-AES-001 AES-128 加密 Base64**
  - key：`1234567890abcdef`，明文：`hello` → Base64：`OuG/HtvQGRTDeeep6ZO/WQ==`
- **TC-AES-002 AES-128 加密 Hex**
  - key：`1234567890abcdef`，明文：`hello` → Hex：`3ae1bf1edbd01914c379e7a9e993bf59`
- **TC-AES-003 AES-256 加密 Base64**
  - key：`1234567890abcdef1234567890abcdef`，明文：`hello` → Base64：`GL32xozLGGfcR605S5ZAyw==`
- **TC-AES-004 解密回原文**
  - 对 TC-AES-001/003 的密文执行解密 → 期望：输出 `hello`

### 7.7 TOOL-005 DES
- **TC-DES-001 DES 加密 Base64**
  - key：`12345678`，明文：`hello` → Base64：`uhbGoCVxJa8=`
- **TC-DES-002 DES 加密 Hex**
  - key：`12345678`，明文：`hello` → Hex：`ba16c6a0257125af`
- **TC-DES-003 解密回原文**
  - 解密 TC-DES-001 的密文 → 期望：`hello`

### 7.8 TOOL-006 Base64 ↔ Hex
- **TC-BH-001 Base64→Hex**
  - 输入：`aGVsbG8=` → 期望：`68656c6c6f`
- **TC-BH-002 Hex→Base64**
  - 输入：`68656c6c6f` → 期望：`aGVsbG8=`

### 7.9 TOOL-007 文本对比
- **TC-DIFF-001 Text 差异**
  - 左：`a\\nb\\n`，右：`a\\nc\\n` → 期望：高亮 b/c 差异
- **TC-DIFF-002 JSON 格式化**
  - 左：`{\"a\":1,\"b\":2}`，右：`{\"b\":2,\"a\":1}`，JSON 模式格式化后 → 期望：可看到仅排序差异（具体策略实现时定义）
- **TC-DIFF-003 非法 JSON**
  - 输入：`{a:1}` → 期望：提示 JSON 非法

### 7.10 TOOL-008 JWT 解码
- **TC-JWT-001 完整 JWT**
  - 输入示例 JWT（见 TOOL-008）→ 期望：Header/Payload 输出 JSON 与示例一致
- **TC-JWT-002 header.payload**
  - 仅输入 `header.payload` → 期望：仍可解析并提示“无签名段”

### 7.11 TOOL-009 时间戳转换
- **TC-TIME-001 UTC 基准**
  - 时区 UTC，输入 `0` → 期望：`1970-01-01 00:00:00`
- **TC-TIME-002 UTC+8 偏移**
  - 时区 UTC+8，输入 `0` → 期望：`1970-01-01 08:00:00`
- **TC-TIME-003 进入页面才刷新**
  1. 切换到时间戳页面，观察“当前时间/当前时间戳”每秒更新
  2. 切换到其他页面，观察停止更新

### 7.12 TOOL-010 变量命名转换
- **TC-NAME-001 基础用例**
  - 输入 `userAge` → 期望输出 7 种格式与 TOOL-010 一致
- **TC-NAME-002 kebab 输入**
  - 输入 `user-age` → 期望小驼峰输出 `userAge`

---

## 8. 执行纪律（严格遵守）
- 任何里程碑开始实现前：先对照本文件确认需求范围与验收用例。
- 每完成一个里程碑：执行 `7.1 旧功能回归` + 对应需求用例；全部通过才进入下一里程碑。
