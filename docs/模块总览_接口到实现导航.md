# 模块总览与接口→实现导航（新手友好版）

> 目标：站在「什么都不懂」的视角，告诉你整个仓库分成哪几块、每块用来干什么、从哪里启动、以及**接口是如何落到具体代码实现上的**。

推荐阅读顺序：
1. 本文（整体地图）
2. `docs/快速开始与依赖.md`（跑起来）
3. 用本文的「接口→实现导航」按图索骥看代码

---

## 一、整体分块概览

可以把整个仓库想象成一个「学习乐园」：

- **语言基础区**：`01.Python语言基础/`
  - 作用：从 0 开始学 Python 语法、常用标准库、并发/网络等基础。
  - 特点：每一章都有中文说明文档 + demo 示例代码 + practice 练习。

- **项目实战区**：`03.项目实战/`
  - 作用：用小项目练习“用 Python 解决实际问题”，比如命令行工具、日志分析、TODO Web API 等。
  - 特点：每个项目目录内有 `XX_项目说明.md`，告诉你怎么运行和扩展。

- **系统综合演练区（微服务 + 前端）**：
  - 后端服务（FastAPI）：
    - `rbac_auth_service/`：认证 / 授权 / 用户与角色权限（端口 8001）
    - `integration_gateway_service/`：API 网关（端口 8000）
    - `backend_user_order_service/`：用户 + 订单示例服务（端口 9000）
    - `log_audit_service/`：审计日志服务（端口 8002）
    - `log_detective_service/`：日志分析服务（端口 9003）
  - 前端页面（纯静态 HTML）：`frontend/`
    - `portal.html` / `index.html`：学习入口 & 章节导航
    - `login.html` / `admin.html`：RBAC 登录 + 管理后台
    - `log-detective.html`：日志侦探，可端到端打通“前端 → 网关 → 日志服务”

**如果你完全不知道从哪里开始**：  
先按 `docs/快速开始与依赖.md` 启动一遍服务，再用本文的「接口→实现」章节跟着看代码。

---

## 二、语言基础区：怎么用、看什么

**目录**：`01.Python语言基础/`

- 每个子目录类似：`05_序列与集合类型`、`10_迭代器与生成器` 等。
- 一般包含：
  - `XX_章节名.md`：中文讲解
  - `demo_*.py`：演示代码
  - `practice_*.py`：带 TODO 的练习代码

**如何使用：**

1. 选一章，比如：`01.Python语言基础/06_函数与参数/`
2. 先打开对应的 md 文档看一遍概念；
3. 在终端运行 demo：
   ```bash
   python 01.Python语言基础/06_函数与参数/demo_functions.py
   ```
4. 再打开 `practice_*.py`，按照注释里的 TODO 提示自己补全代码。

**和前端的联动：**

- `frontend/index.html` 会把这些章节变成左侧导航，你可以在浏览器里点章节、预览 md 文本、加载示例代码到在线编辑器，然后用 Pyodide 在浏览器里运行。

---

## 三、项目实战区：从命令行到 TODO Web API

**目录**：`03.项目实战/`

这里有多个小项目，建议重点关注：

### 1. TODO Web API（FastAPI + SQLite）

- 目录：`03.项目实战/03_TODO_Web_API_FastAPI/`
- 文档：`03.项目实战/03_TODO_Web_API_FastAPI/03_项目说明.md`
- 服务入口：`03.项目实战/03_TODO_Web_API_FastAPI/app/main.py`

**如何启动：**

```bash
cd 03.项目实战/03_TODO_Web_API_FastAPI
uvicorn app.main:app --reload
# 浏览器访问 http://127.0.0.1:8000/docs
```

**接口→实现导航（TODO 项目）**

- `GET /todos`：
  - 接口定义：`app/routers/todos.py` 中的 `list_todos` 函数
  - 数据查询：`db.query(models.Todo).all()` 调用了 `app/models.py` 中定义的 `Todo` ORM 模型
  - 数据结构：返回 `schemas.TodoOut`（`app/schemas.py`）

- `POST /todos`：
  - 接口函数：`create_todo(todo_in: schemas.TodoCreate, db: Session = Depends(get_db))`
  - 数据库会话：`get_db` 来自 `app/database.py`
  - ORM 模型：`models.Todo`（`app/models.py`）

**测试→实现导航：**

- 测试文件：`03_TODO_Web_API_FastAPI/test_todo_api.py`
  - 使用 `TestClient` 调用 `/todos`，并通过依赖覆盖使用内存数据库。
  - 从测试的调用顺序（创建 → 查询 → 更新 → 删除），你可以反向去看对应的路由函数实现。

### 2. 其它小项目（略）

其他项目（命令行重命名、日志分析、销售统计等）都在各自目录的 `XX_项目说明.md` 中说明了运行方式，使用时可以按说明逐一尝试。

---

## 四、系统综合演练：前端 + 五个服务

这一块是「看懂一条真实业务链路」的关键。建议按端口记忆：

- RBAC 服务：`rbac_auth_service`（端口 8001）
- 网关服务：`integration_gateway_service`（端口 8000）
- 审计日志：`log_audit_service`（端口 8002）
- 示例业务：`backend_user_order_service`（端口 9000）
- 日志侦探：`log_detective_service`（端口 9003）
- 前端静态页：`frontend`（通过 `http://127.0.0.1:5500/*.html` 访问）

### 4.1 RBAC 服务（认证与权限）

- 目录：`rbac_auth_service/`
- 文档：`rbac_auth_service/09_项目说明.md`、`rbac_auth_service/项目结构说明.md`
- 应用入口：`rbac_auth_service/app/main.py` 中的 `create_app()` 与 `app = create_app()`
- 典型路由文件：
  - `app/routers/auth.py`：`/auth/login`、`/auth/me` 等认证接口
  - `app/routers/users.py`：`/users/` 用户管理
  - `app/routers/roles.py`：`/rbac/roles` 角色管理
  - `app/routers/permissions.py`（如果有）/ `roles.py` 中权限相关接口
  - `app/routers/todos.py`：受 RBAC 控制的 TODO 示例接口

**接口→实现导航（登录）**

1. 前端：`frontend/login.html`
   - 提交表单到：`POST {authApiBaseUrl}/auth/login`
2. 路由定义：`rbac_auth_service/app/routers/auth.py`
   - 找到 `@router.post("/auth/login")` 对应的函数（通常会调用服务层）
3. 服务层：`rbac_auth_service/app/services/` 目录下，与登录相关的 Service
4. 数据层：`rbac_auth_service/app/models.py`（用户 / 角色 / 权限表结构）

这样你就能从浏览器按钮，一路追踪到具体的 Python 函数和数据库模型。

### 4.2 API 网关服务

- 目录：`integration_gateway_service/`
- 文档：`integration_gateway_service/09_项目说明.md`、`integration_gateway_service/README.md`（如有）
- 应用入口：`integration_gateway_service/app/main.py`
- 路由定义：`integration_gateway_service/app/routers/gateway.py`
  - `/gateway/backend/users/{user_id}`
  - `/gateway/backend/orders`
  - `/gateway/log-detective/analyze`

**接口→实现导航（日志分析转发）**

1. 前端：`frontend/log-detective.html`
   - 调用：`POST {gatewayApiBaseUrl}/gateway/log-detective/analyze`
2. 网关路由：`integration_gateway_service/app/routers/gateway.py`
   - 对应函数：`async def analyze_logs(...)`
   - 内部通过 `LogDetectiveClient` 调用日志侦探服务
3. 日志侦探服务路由：`log_detective_service/app/routers/log_detective.py`
   - 对应函数：`@router.post("/analyze") async def analyze_log_endpoint(...)`
4. 实际分析逻辑：`log_detective_service/app/analyzer.py` 中的 `analyze_logs`

这就是一条完整链路：**浏览器 → 网关 → 日志服务 → 具体分析函数**。

### 4.3 示例业务服务（用户 + 订单）

- 目录：`backend_user_order_service/`
- 应用入口：`backend_user_order_service/app/main.py`
- 模型定义：`backend_user_order_service/app/schemas.py`
- 接口：
  - `GET /api/users/{user_id}` → `get_user` 函数
  - `POST /api/orders` → `create_order` 函数

网关中的 `/gateway/backend/users/{user_id}`、`/gateway/backend/orders` 就是代理到这些接口。

### 4.4 审计日志服务

- 目录：`log_audit_service/`
- 应用入口：`log_audit_service/app/main.py`
- 路由：`log_audit_service/app/routers/audit_logs.py`
  - `POST /logs`：写入审计日志
  - `GET /logs`：查询审计日志

RBAC 和网关在关键操作时会调用这个服务，用于记录审计。

### 4.5 日志侦探服务

- 目录：`log_detective_service/`
- 应用入口：`log_detective_service/app/main.py`
- 路由：`log_detective_service/app/routers/log_detective.py`
  - `POST /internal/log-detective/analyze`：分析日志文本
  - `GET /health`：健康检查
- 实际业务逻辑：`log_detective_service/app/analyzer.py`

---

## 五、前端页面：页面→接口→实现

这里给几个常见场景的「从页面到代码」导航示例。

### 场景 1：登录并进入管理后台

1. 打开 `http://127.0.0.1:5500/login.html`
2. 页面文件：`frontend/login.html`
   - JavaScript 中有：
     ```js
     fetch(`${API_BASE}/auth/login`, { ... })
     ```
3. `API_BASE` 来自 `frontend/config.js` 的 `authApiBaseUrl`，默认是 `http://127.0.0.1:8001`
4. 后端路由：`rbac_auth_service/app/routers/auth.py` 中的 `/auth/login` 实现

想深入看逻辑时，从页面 → config.js → 路由文件 → services/models 即可。

### 场景 2：在管理后台查看用户列表

1. 登录成功后自动跳转 `admin.html`
2. 页面文件：`frontend/admin.html`
   - 内部调用：
     ```js
     apiFetch(`${API_BASE}/users/`)
     ```
3. 后端路由：`rbac_auth_service/app/routers/users.py` 中 `@router.get("/users/")` 对应函数
4. 数据结构：`rbac_auth_service/app/schemas.py` 中用户相关的 Pydantic 模型

### 场景 3：使用日志侦探分析日志

1. 打开 `http://127.0.0.1:5500/log-detective.html`
2. 页面文件：`frontend/log-detective.html`
   - 调用：
     ```js
     apiClient(API_BASE + '/gateway/log-detective/analyze', { ... })
     ```
   - 其中 `API_BASE` 来自 `gatewayApiBaseUrl`（config.js）
3. 网关路由：`integration_gateway_service/app/routers/gateway.py` 中的 `analyze_logs`
4. 日志服务路由：`log_detective_service/app/routers/log_detective.py`
5. 实际分析逻辑：`log_detective_service/app/analyzer.py`

这条链路可以帮助你练习端到端排查：  
**页面效果不对 → 看浏览器控制台请求 → 找到网关路由 → 再看到下游服务的实现**。

---

## 六、如果只记得一张图，要记什么？

1. **从入口开始**
   - 文档入口：`docs/快速开始与依赖.md`
   - 代码入口：
     - 前端：`frontend/portal.html` / `frontend/index.html`
     - 后端：各服务的 `app/main.py`

2. **从接口反推实现**
   - 请求 URL → 端口号 → 服务目录
   - 服务目录 → `app/routers/*.py` → 找到对应路径的函数
   - 再往下看 services / repositories / models

3. **遇到看不懂的地方**  
   - 回到对应章节的基础文档，比如看到 `Depends` / `Session` / `BaseModel` 不熟悉，就回到：
     - `02.开发环境及框架介绍/02.开发环境及框架介绍.md`（FastAPI 概念）
     - `01.Python语言基础/` 相关章节。

当你习惯了这种「页面 / 接口 / 路由 / 实现」的跳转方式，这个仓库就不再是一个黑盒，而是一个随时可以挖的“练功房”。如果后续你觉得某一块还不够清晰，可以在对应模块再拆一份更细的导航文档。***

